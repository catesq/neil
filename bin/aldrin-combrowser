#!/usr/bin/env python

import os, sys, imp

if '--debug' in sys.argv:
	sys.argv.remove('--debug')
	os.system('gdb --eval-command=run -q --args python "%s"$*' % sys.argv[0])
	raise SystemExit, 0
if '--pydebug' in sys.argv:
	sys.argv.remove('--pydebug')
	os.system('winpdb "%s"$*' % sys.argv[0])
	raise SystemExit, 0

CWD = os.path.abspath(os.path.join(os.path.dirname(__file__)))
if os.path.isfile(os.path.join(CWD, 'this_is_a_repository')):
	module_path = os.path.normpath(os.path.join(CWD, '../src'))
	print "adding " + module_path + " to sys.path"
	sys.path = [module_path] + sys.path

def init_combrowser():
	import aldrin.com as com
	import gtk
	# startup python console, too
	browser = com.get('aldrin.pythonconsole.dialog', False)
	browser.connect('destroy', lambda widget: gtk.main_quit())
	browser.show_all()
	browser = com.get('aldrin.componentbrowser.dialog', False)
	browser.connect('destroy', lambda widget: gtk.main_quit())
	browser.show_all()

import aldrin.main
aldrin.main.run(sys.argv, init_combrowser)

